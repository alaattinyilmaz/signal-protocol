Here is my private Identity Key
75151745874135875874574268787

I've already registered my IK and SPK to server. So I'm skipping those registration parts. But if you havent registered in the Phase 1 or forgot you keys, you can reset your keys and register again. See the sample vector of Phase 1 

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
But I didn't kept the OTKs so I'm creating them again.
If you did you can also skip this part.

My private SPK is: 33657798038556164666333156772648370465723618440887378500698724247855133498541
Server's Public SPK is (x and y): 85040781858568445399879179922879835942032506645887434621361669108644661638219, 46354559534391251764410704735456214670494836161052287022185178295305851364841

OTKs are generated and registered. This is my full list of OTKs

{0: [78556473768328026901455561156646199315949835620693337770986065030788602641036, 9042916165903115439571504916172283616066826567340091446831672868021415793654, 23017502529866747616119041489865163769497976866516227657875248958068251190229], 1: [33505470677225000759811777023769723743963059347710349238410301805399201585780, 52492246637146783468204089604288041279147071620877430879777785013054143280600, 58210285592904377420189369437817462992365074752915045514130119293328442422398], 2: [80666855314480851642071830748124139751596692803829164562057356773748806078897, 7081122647688404201933448131690129734990616863747845274077322065700552099506, 60684566549327547285839695344763185998708297800093380418113761368410382287018], 3: [41517441994392424775504331333305330801801726077642785971165397044174440827853, 14979603826033752513133825240283486547509491081438278524428486470477544752080, 65342591342789729073538019242203385615609612399686113216914463159670470228458], 4: [73506245294452971752108370258645479758922193499131836132626221423651463078004, 34454315933651549577802027446090638379481619488164637728367730420901023032695, 78236061684972437087351231511846426778219948607893766936352222882736397286093], 5: [92688317569787285672340166741584347345964118033368631680807946406328493605849, 23103332898310948354603256629846041230951286492283772955773907350771866303114, 64039634290498117006375641378654081003093553741413003276017468491679902591309], 6: [106088266812877026192201599487009647396600147682562220220739764661169485323469, 16431056674455853745250695274382214036401247966906347579909264627170906985792, 38721974345631952623340173298404186277700801421180232940031560587050604779403], 7: [99403982959444669036707942239313011489545541518078882990066481397725557382222, 17958153194588877229384950431564182276248655389260148272124347666694358446419, 83441457517929510434429003574337715114837191315140063605201913053840508785501], 8: [49244805338858517057921872152368951538050710638073331914414414485076961875656, 74134402059221183857372131524641995909275345681362018042262119484192987561586, 94871701406772183551697496277374132530144576680589285143382188171590976668910], 9: [35219389677360454228389989274997124317075477010965741600674383807521534667035, 60538233197607307086507566007320919906340304989622636496367184856761598046773, 84152587339885947518432785887496701062922665533984096713353074965525778574656]}

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Telling pseudoclient to send me messages using PseudoSendMsg

Signing my stuID with my private IK
(In signature generation I fixed the random variable to 1748178 so that you can re-generate if you want)

Sending message is:  {'ID': 18007, 'H': 72529688552234813461176358403380091606421598571244435361965114142926190813402, 'S': 81460309625287794236351290341420509850411861301523749902617369500087613438150}
Returned message: Your favourite pseudo-client sent you 5 messages. You can get them from the server

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Sending message is:  {'ID': 18007, 'H': 72529688552234813461176358403380091606421598571244435361965114142926190813402, 'S': 81460309625287794236351290341420509850411861301523749902617369500087613438150}
{'IDB': 2014, 'OTKID': 0, 'MSGID': 1, 'MSG': 186433465447820545639580266160192984356950818371838136764536956881506863006385672974033053916966394433797675185628030107424869213122616646778171609697850577083593959424864495834125295705160491805665, 'EK.X': 79237835454166601874788097368209777742285657544485056200473838795200193831917, 'EK.Y': 30861790451881570834154592646626644789321972280410142357204508521453926689857}
I got this from client 2014: 
 186433465447820545639580266160192984356950818371838136764536956881506863006385672974033053916966394433797675185628030107424869213122616646778171609697850577083593959424864495834125295705160491805665

Converting message to bytes to decrypt it...
Converted message is:
 b'\x9f\x9e\xa9G\xebna\xa6r\xf0G\x0b\xd4\xb4\x9a\x95\x85\x08&\xed\x10I\xff\x85\xa6\xb3\xb9p\xe6WP\xd8L\x1d\x14\xd2\x0c,\x8f\xcb\xc3\x13\x15XB\x07\x85\xfb\xc6\xbd-\xe6:\xa4\x9c\x8e\xdcX\xdd\x89\xfd\xda&\xa1?2\xb7\xc6G\x9f\x11\xed\x8c\xd5\x89"\xa9\xa8)q+\xe1'

Seperate nonce, ciphertext and hmac parts

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Generating session key ...
T is: 
 (0x51925a9f5a6cd8ef765934c408be8945f0e67a9c670e55f4c0039e776cd7e084 , 0x1e28b7591ae1043100eee8f67ea165d7b097ccd4e6ffb9a2e3d36f42dedaf708)
U is: 
 b'Q\x92Z\x9fZl\xd8\xefvY4\xc4\x08\xbe\x89E\xf0\xe6z\x9cg\x0eU\xf4\xc0\x03\x9ewl\xd7\xe0\x84\x1e(\xb7Y\x1a\xe1\x041\x00\xee\xe8\xf6~\xa1e\xd7\xb0\x97\xcc\xd4\xe6\xff\xb9\xa2\xe3\xd3oB\xde\xda\xf7\x08MadMadWorld'
Ks is: 
 b'\x97\x9c\xee;5\x1d@8\x84A\x82\xfeG\x05{03;ct\xef1\x02\x90\xdf0\x99v]\xa4\x14\xab'

Kenc1 is: 
 b'+\xcb#\xda\xf0\xe1@\xdf&MZ\x89\xc9\x0e\xe95(\xbfI\xd1\\ZrS7B[\x0e\xdc\xb0.q'
Khmac1 is: 
 b'b\x96RA\xe5\x93\x85\xae\x88\xf6\xa5ic\xe8\xc5G3\x91y/\x14\x8aU\x067\xd6\x12q\x99\xb8\xaa\t'
Kkdf1 is: 
 b'\xf2\xe9\xc5\xa43\xf6P0:EA\xd7O\xff\xf7r\xeb]m\xfdg\x0e\xe0k\xbe7\xb5\x9d\xdd\x01\x8b\xaa'

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

calculated hmac is
 b'-\xe6:\xa4\x9c\x8e\xdcX\xdd\x89\xfd\xda&\xa1?2\xb7\xc6G\x9f\x11\xed\x8c\xd5\x89"\xa9\xa8)q+\xe1'
Hmac verified

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Create an AES object with Kenc then decrypt the ciphertext:
Plaintext is:
this is a dummy mesage I'll change it soon
Sending message is:  {'IDA': 18007, 'IDB': 2014, 'MSGID': 1, 'DECMSG': "this is a dummy mesage I'll change it soon"}
You decrypted it correctly, wow!

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Sending message is:  {'ID': 18007, 'H': 72529688552234813461176358403380091606421598571244435361965114142926190813402, 'S': 81460309625287794236351290341420509850411861301523749902617369500087613438150}
{'IDB': 2014, 'OTKID': 0, 'MSGID': 2, 'MSG': 85478496732223507148841499514288605532786723485761295172800156072822305688825044029919935145390508015332288740713108103924575961197143456142571978945401875499945854424510920765132492409400081406585, 'EK.X': 79237835454166601874788097368209777742285657544485056200473838795200193831917, 'EK.Y': 30861790451881570834154592646626644789321972280410142357204508521453926689857}

I got this from client 2014: 
 85478496732223507148841499514288605532786723485761295172800156072822305688825044029919935145390508015332288740713108103924575961197143456142571978945401875499945854424510920765132492409400081406585

Converting message to bytes to decrypt it...
Converted message is:
 b'I/A\xbfu\x95\x1b\x85\xa24\x84\xc4*0\xc8\xdc2|\x16T\xb3A\xc1fK2\xf3\x93\x0e\xcc\xea\xb0\xe2\x80\xa4\xad\x17\xd4\x94\xd2o\xc2D\x89\x11\xc4\x1f\x16\xb8kY-UB\xcf\x9fZ\xd8\xfe\xd6kF\x95\x85\x00\xba]\x93.>`\xf5\xb2{9I@\xe0\xeb\x9aZy'

Generating session key ...
T is: 
 (0x51925a9f5a6cd8ef765934c408be8945f0e67a9c670e55f4c0039e776cd7e084 , 0x1e28b7591ae1043100eee8f67ea165d7b097ccd4e6ffb9a2e3d36f42dedaf708)
U is: 
 b'Q\x92Z\x9fZl\xd8\xefvY4\xc4\x08\xbe\x89E\xf0\xe6z\x9cg\x0eU\xf4\xc0\x03\x9ewl\xd7\xe0\x84\x1e(\xb7Y\x1a\xe1\x041\x00\xee\xe8\xf6~\xa1e\xd7\xb0\x97\xcc\xd4\xe6\xff\xb9\xa2\xe3\xd3oB\xde\xda\xf7\x08MadMadWorld'
Ks is: 
 b'\x97\x9c\xee;5\x1d@8\x84A\x82\xfeG\x05{03;ct\xef1\x02\x90\xdf0\x99v]\xa4\x14\xab'

Kenc1 is: 
 b'+\xcb#\xda\xf0\xe1@\xdf&MZ\x89\xc9\x0e\xe95(\xbfI\xd1\\ZrS7B[\x0e\xdc\xb0.q'
Khmac1 is: 
 b'b\x96RA\xe5\x93\x85\xae\x88\xf6\xa5ic\xe8\xc5G3\x91y/\x14\x8aU\x067\xd6\x12q\x99\xb8\xaa\t'
Kkdf1 is: 
 b'\xf2\xe9\xc5\xa43\xf6P0:EA\xd7O\xff\xf7r\xeb]m\xfdg\x0e\xe0k\xbe7\xb5\x9d\xdd\x01\x8b\xaa'

Kenc2 is: 
 b'\xb5\xf6\x9e\xb5l)T\xb0B\x08\xddN\x12\xe6l\x17o\xad\xb1d\xdeY\xd0S6\x8a0\xe3Gv){'
Khmac2 is: 
 b'wZo_2\xad\t\x1d\x8f+\x9e\x00\xc5\x90\xa5\x07\x9a\xd3\xf4\x9a\\%\x0c>\x9c\xf0_L\x15+9\x9c'
Kkdf2 is: 
 b'\xa9\x11\xba\x04^\xcb[\xa4\\\x8b\x8f\xfbxT\x13+EJ}\xc3,\x18w\x9bP\x9d6\x05\xc6\x9d\xfa\xd4'

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
calculated hmac is
 b'Y-UB\xcf\x9fZ\xd8\xfe\xd6kF\x95\x85\x00\xba]\x93.>`\xf5\xb2{9I@\xe0\xeb\x9aZx'

Hmac couldn't be verified

Sending message is:  {'IDA': 18007, 'IDB': 2014, 'MSGID': 2, 'DECMSG': 'INVALIDHMAC'}
You've found the faulty message. Good job!

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
